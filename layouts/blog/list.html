{{ define "main" }}
  <!-- Dark mode toggle -->
  <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
    <svg id="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
    <svg id="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
    </svg>
  </button>

  <main class="blog-page">
    
    <!-- Hero Section -->
    <section class="blog-hero">
      <div class="hero-container">
        <div class="hero-content">
          <h1 class="hero-title">
            <span class="title-icon">üìö</span>
            Blog L·∫≠p Tr√¨nh M·∫°ng
          </h1>
          <p class="hero-description">
            Kh√°m ph√° nh·ªØng ki·∫øn th·ª©c s√¢u v·ªÅ l·∫≠p tr√¨nh m·∫°ng, c√¥ng ngh·ªá backend v√† c√°c xu h∆∞·ªõng ph√°t tri·ªÉn ph·∫ßn m·ªÅm m·ªõi nh·∫•t
          </p>
          
          <!-- Search and Filter -->
          <div class="blog-controls">
            <div class="search-wrapper">
              <input type="text" id="blog-search" placeholder="T√¨m ki·∫øm b√†i vi·∫øt..." class="blog-search-input">
              <button id="search-btn" class="search-button">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"></circle>
                  <path d="m21 21-4.35-4.35"></path>
                </svg>
              </button>
            </div>
            
            <div class="filter-wrapper">
              <select id="category-filter" class="category-filter">
                <option value="">T·∫•t c·∫£ ch·ªß ƒë·ªÅ</option>
                <option value="java">Java</option>
                <option value="javascript">JavaScript</option>
                <option value="networking">Networking</option>
                <option value="backend">Backend</option>
                <option value="tutorial">Tutorial</option>
              </select>
            </div>
          </div>
          
          <!-- Blog Stats -->
          <div class="blog-stats">
            <div class="stat-item">
              <span class="stat-number">{{ len (where .Site.RegularPages "Section" "blog") }}</span>
              <span class="stat-label">B√†i vi·∫øt</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">{{ len .Site.Taxonomies.categories }}</span>
              <span class="stat-label">Ch·ªß ƒë·ªÅ</span>
            </div>
            <div class="stat-item">
              <span class="stat-number">1000+</span>
              <span class="stat-label">L∆∞·ª£t ƒë·ªçc</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Blog Content -->
    <section class="blog-content">
      <div class="content-container">
        
        <!-- Featured Posts -->
        <div class="featured-section">
          <h2 class="section-title">
            <span class="title-icon">‚≠ê</span>
            B√†i vi·∫øt n·ªïi b·∫≠t
          </h2>
          <div class="featured-posts">
            {{ range first 2 (where .Site.RegularPages "Section" "blog") }}
              <article class="featured-post">
                <a href="{{ .Permalink }}" class="featured-link">
                  <div class="featured-image">
                    {{ with .Params.featured_image }}
                    <img src="{{ . }}" alt="{{ $.Title }}" loading="lazy">
                    {{ else }}
                      <div class="featured-placeholder">
                        <svg viewBox="0 0 24 24" width="48" height="48" stroke="currentColor" stroke-width="1" fill="none">
                          <path d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                      </div>
                    {{ end }}
                    <div class="featured-overlay">
                      <span class="featured-badge">N·ªïi b·∫≠t</span>
                    </div>
                  </div>
                  <div class="featured-content">
                    <h3 class="featured-title">{{ .Title }}</h3>
                    <p class="featured-excerpt">
                      {{ with .Summary }}
                        {{ . | plainify | truncate 150 }}
                      {{ else }}
                        {{ .Plain | truncate 150 }}
                      {{ end }}
                    </p>
                    <div class="featured-meta">
                      <time class="featured-date">{{ .Date.Format "02 Jan 2006" }}</time>
                      <span class="featured-reading-time">{{ .ReadingTime }} ph√∫t ƒë·ªçc</span>
                    </div>
                  </div>
                </a>
              </article>
            {{ end }}
          </div>
        </div>

        <!-- All Posts -->
        <div class="all-posts-section">
          <h2 class="section-title">
            <span class="title-icon">üìù</span>
            T·∫•t c·∫£ b√†i vi·∫øt
          </h2>
          
          <div class="posts-grid" id="posts-container">
            {{ range (where .Site.RegularPages "Section" "blog") }}
              <article class="post-card" data-categories="{{ delimit .Params.categories " " }}">
                <a href="{{ .Permalink }}" class="post-link">
                  <div class="post-image-wrapper">
                    {{ with .Params.featured_image }}
                    <img src="{{ . }}" alt="{{ $.Title }}" loading="lazy">
                    {{ else }}
                      <div class="post-placeholder">
                        <svg viewBox="0 0 24 24" width="32" height="32" stroke="currentColor" stroke-width="1.5" fill="none">
                          <path d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                        </svg>
                      </div>
                    {{ end }}
                    <div class="post-overlay"></div>
                  </div>
                  
                  <div class="post-content">
                    <div class="post-categories">
                      {{ range .Params.categories }}
                        <span class="category-tag">{{ . }}</span>
                      {{ end }}
                    </div>
                    
                    <h3 class="post-title">{{ .Title }}</h3>
                    
                    <p class="post-excerpt">
                      {{ with .Summary }}
                        {{ . | plainify | truncate 120 }}
                      {{ else }}
                        {{ .Plain | truncate 120 }}
                      {{ end }}
                    </p>
                    
                    <div class="post-meta">
                      <time class="post-date">{{ .Date.Format "02 Jan 2006" }}</time>
                      <span class="post-reading-time">{{ .ReadingTime }} ph√∫t</span>
                    </div>
                  </div>
                  
                  <div class="post-footer">
                    <span class="read-more">ƒê·ªçc ti·∫øp ‚Üí</span>
                  </div>
                </a>
              </article>
            {{ end }}
          </div>
          
          <!-- No Results Message -->
          <div id="no-results" class="no-results" style="display: none;">
            <div class="no-results-icon">üîç</div>
            <h3 class="no-results-title">Kh√¥ng t√¨m th·∫•y b√†i vi·∫øt</h3>
            <p class="no-results-text">Th·ª≠ thay ƒë·ªïi t·ª´ kh√≥a t√¨m ki·∫øm ho·∫∑c ch·ªçn ch·ªß ƒë·ªÅ kh√°c</p>
          </div>
        </div>

        <!-- Newsletter Signup -->
        <div class="newsletter-section">
          <div class="newsletter-content">
            <h2 class="newsletter-title">üì¨ ƒêƒÉng k√Ω nh·∫≠n b√†i vi·∫øt m·ªõi</h2>
            <p class="newsletter-description">
              Nh·∫≠n th√¥ng b√°o v·ªÅ nh·ªØng b√†i vi·∫øt m·ªõi nh·∫•t v·ªÅ l·∫≠p tr√¨nh m·∫°ng v√† c√¥ng ngh·ªá
            </p>
            <form class="newsletter-form" id="newsletter-form">
              <input type="email" placeholder="Email c·ªßa b·∫°n..." class="newsletter-input" required>
              <button type="submit" class="newsletter-button">ƒêƒÉng k√Ω</button>
            </form>
            <p class="newsletter-note">Ch√∫ng t√¥i t√¥n tr·ªçng quy·ªÅn ri√™ng t∆∞ c·ªßa b·∫°n. Kh√¥ng spam!</p>
          </div>
        </div>

      </div>
    </section>

  </main>

  <!-- Include CSS and JavaScript -->
  {{ $blogCSS := resources.Get "styles/blog.css" | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $blogCSS.RelPermalink }}" integrity="{{ $blogCSS.Data.Integrity }}">
  
  <script>
    // Dark mode functionality
    (function() {
      const themeToggle = document.getElementById('theme-toggle');
      const sunIcon = document.getElementById('sun-icon');
      const moonIcon = document.getElementById('moon-icon');
      
      const savedTheme = localStorage.getItem('theme') || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      
      function updateIcons(theme) {
        if (theme === 'dark') {
          sunIcon.style.display = 'none';
          moonIcon.style.display = 'block';
        } else {
          sunIcon.style.display = 'block';
          moonIcon.style.display = 'none';
        }
      }
      
      updateIcons(savedTheme);
      
      themeToggle.addEventListener('click', function() {
        const currentTheme = document.documentElement.getAttribute('data-theme');
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        document.documentElement.setAttribute('data-theme', newTheme);
        localStorage.setItem('theme', newTheme);
        updateIcons(newTheme);
      });
    })();

    // Blog Search and Filter functionality
    (function() {
      const searchInput = document.getElementById('blog-search');
      const categoryFilter = document.getElementById('category-filter');
      const postsContainer = document.getElementById('posts-container');
      const noResults = document.getElementById('no-results');
      const allPosts = document.querySelectorAll('.post-card');

      function filterPosts() {
        const searchTerm = searchInput.value.toLowerCase();
        const selectedCategory = categoryFilter.value.toLowerCase();
        let visibleCount = 0;

        allPosts.forEach(post => {
          const title = post.querySelector('.post-title').textContent.toLowerCase();
          const excerpt = post.querySelector('.post-excerpt').textContent.toLowerCase();
          const categories = post.dataset.categories.toLowerCase();
          
          const matchesSearch = !searchTerm || title.includes(searchTerm) || excerpt.includes(searchTerm);
          const matchesCategory = !selectedCategory || categories.includes(selectedCategory);
          
          if (matchesSearch && matchesCategory) {
            post.style.display = 'block';
            post.classList.add('animate-in');
            visibleCount++;
          } else {
            post.style.display = 'none';
            post.classList.remove('animate-in');
          }
        });

        // Show/hide no results message
        if (visibleCount === 0) {
          noResults.style.display = 'block';
        } else {
          noResults.style.display = 'none';
        }
      }

      // Event listeners
      searchInput.addEventListener('input', filterPosts);
      categoryFilter.addEventListener('change', filterPosts);

      // Newsletter form
      const newsletterForm = document.getElementById('newsletter-form');
      newsletterForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const email = this.querySelector('.newsletter-input').value;
        
        // Simple validation
        if (email && email.includes('@')) {
          alert('C·∫£m ∆°n b·∫°n ƒë√£ ƒëƒÉng k√Ω! Ch√∫ng t√¥i s·∫Ω g·ª≠i th√¥ng b√°o v·ªÅ nh·ªØng b√†i vi·∫øt m·ªõi.');
          this.reset();
        } else {
          alert('Vui l√≤ng nh·∫≠p email h·ª£p l·ªá.');
        }
      });

      // Animations on scroll
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-in');
          }
        });
      }, observerOptions);

      // Observe all post cards
      allPosts.forEach(post => {
        observer.observe(post);
      });
    })();
  </script>
{{ end }}
